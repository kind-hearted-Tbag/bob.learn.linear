{% set name = 'bob.learn.linear' %}

package:
  name: {{ name }}
  version: {{ environ.get('BOB_PACKAGE_VERSION', '0.0.1') }}

build:
  number: {{ environ.get('BOB_BUILD_NUMBER', 0) }}
  script:
    - cd {{ environ.get('CI_PROJECT_DIR', environ.get('RECIPE_DIR') + '/..') }}
    {% if environ.get('BUILD_EGG') %}
    - python setup.py sdist --formats=zip
    {% endif %}
    - pip install .
    - sphinx-build -W doc $PREFIX/docs/{{ name }}
  script_env:
   - BOB_DOCUMENTATION_SERVER

requirements:
  build:
    - python
    - setuptools
    - toolchain {{ toolchain }}
    - sphinx
    - sphinx_rtd_theme
    - bob.extension >2.0.4
    - bob.blitz
    - bob.core
    - bob.io.base
    - bob.math
    - bob.learn.activation
    # bob.io.matlab may be removed from dependencies in future
    - bob.io.matlab
    - cmake
    - scipy
    - pkg-config
    - libblitz {{ libblitz }}
    - boost {{ boost }}
    - numpy {{ numpy }}
    - gcc {{ gcc }}  # [linux]
    - libgcc {{ libgcc }}  # [linux]
  run:
    - python
    - setuptools
    - bob.extension >2.0.4
    - bob.blitz
    - bob.core
    - bob.io.base
    - bob.math
    - bob.learn.activation
    # bob.io.matlab may be removed from dependencies in future
    - bob.io.matlab
    - scipy
    - libblitz
    - boost
    - {{ pin_compatible('numpy', min_pin='x.x', max_pin='x.x') }}
    - libgcc  # [linux]

test:
  imports:
    - {{ name }}
  commands:
    - nosetests --with-coverage --cover-package={{ name }} -sv {{ name }}
    # The doctests will run only if "CI_PROJECT_DIR" is available as an
    # environment variable. If you are testing locally, you can set it to the
    # root of your project.
    - sphinx-build -b doctest {{ environ.get('CI_PROJECT_DIR') }}/doc sphinx
  requires:
    - nose
    - coverage
    - sphinx
    - sphinx_rtd_theme

about:
  home: https://www.idiap.ch/software/bob/
  license: BSD 3-Clause
  summary: Bob's Linear Machine and its Trainers
  license_family: BSD
